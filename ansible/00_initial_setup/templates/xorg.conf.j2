# Copyright 2025 Alejandro Martínez Corriá and the Thinkube contributors
# SPDX-License-Identifier: Apache-2.0

# Xorg configuration for GPU passthrough setup
# Generated by Ansible for {{ inventory_hostname }} on {{ ansible_date_time.date }}
#
# This configuration forces the system to use a specific GPU for display
# while allowing other GPUs to be used for passthrough to VMs

Section "Device"
    Identifier "Host GPU"
    Driver "{{ xorg_driver }}"
    {% if xorg_busid is defined %}BusID "{{ xorg_busid }}"{% endif %}
    Option "AccelMethod" "glamor"
    Option "DRI" "3"
    # Prevent X from using passthrough GPUs
    Option "AutoAddGPU" "false"
EndSection

Section "ServerLayout"
    Identifier "Default Layout"
    Option "AllowEmptyInput" "true"
    Option "AutoAddGPU" "false"
EndSection