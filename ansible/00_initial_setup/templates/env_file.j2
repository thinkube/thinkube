# Copyright 2025 Alejandro Martínez Corriá and the Thinkube contributors
# SPDX-License-Identifier: Apache-2.0

# Thinkube Environment Variables
# Generated by Ansible on {{ ansible_date_time.date }}
# Inventory is the source of truth for core variables
# Additional variables from previous setups are preserved

# Network Configuration
DOMAIN_NAME={{ domain_name }}
NETWORK_CIDR={{ network_cidr }}
NETWORK_GATEWAY={{ network_gateway }}
{% if zerotier_network_id is defined %}
ZEROTIER_NETWORK_ID={{ zerotier_network_id }}
{% endif %}

# Server Configuration
{% for host in groups['baremetal'] %}
{{ host | upper }}_IP={{ hostvars[host]['ansible_host'] }}
{% endfor %}

# User Configuration
ADMIN_USERNAME={{ admin_username }}

# Preserved variables from existing .env file
{% if existing_variables is defined %}
{% for var_name, var_value in existing_variables.items() %}
{% if var_name not in ['DOMAIN_NAME', 'NETWORK_CIDR', 'NETWORK_GATEWAY', 'ZEROTIER_NETWORK_ID', 'ADMIN_USERNAME'] 
   and not var_name.endswith('_IP') %}
{{ var_name }}={{ var_value }}
{% endif %}
{% endfor %}
{% endif %}