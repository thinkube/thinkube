# Copyright 2025 Alejandro Mart√≠nez Corri√° and the Thinkube contributors
# SPDX-License-Identifier: Apache-2.0

# Jupyter Agent Development - AI agent development environment
# Base: jupyter-ml-gpu (PyTorch + CUDA + ML libraries)
# Includes: LangChain, CrewAI, FAISS for agent development

FROM {{ harbor_registry }}/library/tk-jupyter-ml-gpu:latest

USER $NB_UID

# Install LangChain and related packages
RUN pip install --no-cache-dir \
    langchain==0.3.27 \
    langchain-community==0.3.31 \
    langchain-openai==0.3.35

# Install CrewAI and tools
RUN pip install --no-cache-dir \
    crewai==0.203.1 \
    crewai-tools==0.76.0

# Install FAISS for vector similarity search
RUN pip install --no-cache-dir \
    faiss-cpu==1.12.0

# All Thinkube service clients and chromadb are inherited from base image

# Note: ENTRYPOINT and startup script are inherited from base image
# But we need to override with our image name
USER root
COPY startup.sh /usr/local/bin/startup.sh
RUN chmod +x /usr/local/bin/startup.sh
USER $NB_UID

# ü§ñ AI-assisted