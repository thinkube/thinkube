# Copyright 2025 Alejandro Martínez Corriá and the Thinkube contributors
# SPDX-License-Identifier: Apache-2.0

# Model Mirror Image
# Purpose: Pre-built image for mirroring HuggingFace models to MLflow
# Contains: huggingface_hub and mlflow libraries
# Used by: Argo Workflows model download tasks

FROM {{ harbor_registry }}/library/python:3.12-slim

# Install required packages for model mirroring
RUN pip install --no-cache-dir --break-system-packages \
    huggingface_hub \
    mlflow \
    transformers \
    torch --index-url https://download.pytorch.org/whl/cpu \
    tensorflow-cpu

WORKDIR /app

# Set default HuggingFace home (can be overridden)
ENV HF_HOME=/models/huggingface
