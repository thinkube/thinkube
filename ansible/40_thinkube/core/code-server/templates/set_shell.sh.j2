#!/bin/bash
# Set default shell for terminals
set_shell() {
  local shell_choice=$1
  local settings_file="/home/thinkube/.local/share/code-server/User/settings.json"

  if [ -z "$shell_choice" ]; then
    echo "Usage: set_shell <bash|zsh|fish>"
    echo ""
    echo "Current shell settings:"
    if [ -f "$settings_file" ]; then
      grep "terminal.integrated.defaultProfile.linux" "$settings_file" || echo "  Not set (defaults to bash)"
    else
      echo "  Not set (defaults to bash)"
    fi
    return 1
  fi

  case "$shell_choice" in
    bash|zsh|fish)
      # Update VS Code settings
      if [ -f "$settings_file" ]; then
        # Use jq to update the setting
        jq '."terminal.integrated.defaultProfile.linux" = "'$shell_choice'"' "$settings_file" > "$settings_file.tmp" && mv "$settings_file.tmp" "$settings_file"
      else
        # Create new settings file
        mkdir -p "$(dirname "$settings_file")"
        echo '{"terminal.integrated.defaultProfile.linux": "'$shell_choice'"}' > "$settings_file"
      fi
      echo "Default shell set to $shell_choice"
      echo "Reload VS Code window or open a new terminal to apply changes"
      ;;
    *)
      echo "Error: Invalid shell. Choose: bash, zsh, or fish"
      return 1
      ;;
  esac
}
