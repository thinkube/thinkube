# Copyright 2025 Alejandro Martínez Corriá and the Thinkube contributors
# SPDX-License-Identifier: Apache-2.0

FROM {{ harbor_registry }}/library/jupyter-datascience-notebook:latest

# Install additional Python packages
# You can add or remove packages from this list as needed
RUN pip install --no-cache-dir \
    black \
    jupyterlab-git \
    matplotlib \
    pandas \
    scikit-learn \
    seaborn \
    torch \
    minio \
    python-dotenv \
    qdrant-client \
    opensearch-py \
    opensearch-dsl \
    opensearch-py-ml \
    psycopg2-binary \
    grafana-client \
    prometheus-client \
    gradio \
    transformers \
    spacy \
    openai \
    anthropic \
    kubernetes \
    xgboost \
    jupyterlab-nvdashboard \
    jupyter-ai

# If you need system dependencies, you can add them here
USER root
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    graphviz \
    && apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Copy user package management script
COPY scripts/user-package-manager.sh /usr/local/bin/
RUN chmod +x /usr/local/bin/user-package-manager.sh

# Switch back to jovyan user
USER jovyan

# Set up the environment
WORKDIR /home/jovyan